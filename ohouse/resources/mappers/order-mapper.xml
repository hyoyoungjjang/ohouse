<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="orderMapper">
  	<resultMap id="productResultSet" type="Product">
  		<result column="PRODUCT_ID" property="productId" />
  		<result column="PRODUCT_NAME" property="productName" />
  		<result column="PRODUCT_PRICE" property="productPrice" />
  		<result column="PRODUCT_SALES" property="productSales" />
  		<result column="STOCK" property="stock" />
  		<result column="DELIVERY_DATE" property="arrivalDate" />
  		<result column="SALE" property="sale" />
  		<result column="PRODUCT_CONTENT" property="productContent" />
  		<result column="PRODUCT_CREATE_TIME" property="productCreateTime" />
  		<result column="PRODUCT_MODIFY_TIME" property="productModifyTime" />
  		<result column="COMPANY_NAME" property="companyName" />
  		<result column="PRODUCT_DELIVERY_PRICE" property="productDeliveryPrice" />
  		<result column="PRODUCT_CATEGORY" property="productCategory" />
  		<result column="PRODUCT_STATUS" property="productStatus" />
  		<result column="REVIEW_COUNT" property="reviewCount" />
  		<result column="RATING_AVG" property="ratingAvg" />
  		<result column="PRODUCT_THUMBNAIL" property="productThumbnail" />
  		<result column="MEMBERS_NO" property="membersNo" />
  	</resultMap>
  	<resultMap type="Category" id="CategoryRset">
  		<result column="OPTIONS_NO" property="optionsNo" />
  		<result column="OPTIONS_PDOPT_ID" property="productOptionsId" />
  		<result column="OPTIONS_CATEGORY" property="optionsCategory" />
  	</resultMap>
  	<resultMap type="OptionsName" id="OptionsNameRset">
  		<result column="OPTIONS_NAME_NO" property="optionsNameNo" />
  		<result column="OPTIONS_NAME_OPT_NO" property="optionsCategoryNo" />
  		<result column="OPTIONS_NAME" property="optionsName" />
  		<result column="OPTIONS_PRICE" property="price" />
  		<result column="OPTIONS_STOCK" property="stock" />
  	</resultMap>
  	
  <select id="selectDetailProduct" resultMap="productResultSet">
   SELECT
		P.PRODUCT_ID,
		PRODUCT_NAME,
		PRODUCT_PRICE,
		PRODUCT_SALES,
		STOCK,
		DELIVERY_DATE,
		SALE,
		PRODUCT_CONTENT,
		PRODUCT_CREATE_TIME,
		PRODUCT_MODIFY_TIME,
		P.MEMBERS_NO,
		PRODUCT_DELIVERY_PRICE,
		PRODUCT_CATEGORY,
		FILE_PATH || CHANGE_NAME AS "PRODUCT_THUMBNAIL"
	FROM PRODUCT P
	JOIN MEDIA MED ON (P.PRODUCT_ID = MED.PRODUCT_ID)
   	JOIN MEMBERS MEM ON (P.MEMBERS_NO = MEM.MEMBERS_NO)
	WHERE P.PRODUCT_ID = #{productId}
    AND PRODUCT_STATUS = 'Y'
    AND FILE_LEVEL = 1
		
  </select>
  
  <select id="selectCategory" resultMap="CategoryRset">
  	SELECT
  		OPTIONS_NO, OPTIONS_PDOPT_ID, OPTIONS_CATEGORY
  	FROM OPTIONS_CATEGORY
  	WHERE OPTIONS_NO = #{cgNo}
  </select>
  
  <select id="selectOptionsName" resultMap="OptionsNameRset">
  	SELECT
  		OPTIONS_NAME_NO, OPTIONS_NAME_OPT_NO, 
  		OPTIONS_NAME, OPTIONS_PRICE, OPTIONS_STOCK
  	FROM OPTIONS_NAME
  	WHERE OPTIONS_NAME_NO = #{optNameNo}
  </select>
 </mapper>

  
